var state_data = {
  "US": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 74,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 81,
      "reliability": 80,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 66,
      "record_shows": 60
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 89,
      "privacy": 88,
      "data": 84
    },
    "id": "US",
    "name": "National"
  },
  "AL": {
    "helped_local_communities": 52, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 73,
      "job": 56
    },
    "internet_service": { // NCT 2
      "download_speed": 76,
      "quality": 77,
      "reliability": 76,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 65,
      "record_shows": 59
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 89,
      "privacy": 87,
      "data": 83
    },
    "id": "AL",
    "name": "Alabama"
  },
  "AK": {
    "helped_local_communities": 44, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 75,
      "local": 70,
      "job": 63
    },
    "internet_service": { // NCT 2
      "download_speed": 76,
      "quality": 82,
      "reliability": 81,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 77,
      "record_shows": 65
    },
    "gig_speed": 67, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 91,
      "privacy": 91,
      "data": 86
    },
    "id": "AK",
    "name": "Alaska"
  },
  "AZ": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 75,
      "local": 72,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 81,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 70,
      "record_shows": 61
    },
    "gig_speed": 63, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 90,
      "privacy": 89,
      "data": 85
    },
    "id": "AZ",
    "name": "Arizona"
  },
  "AR": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 76,
      "local": 73,
      "job": 55
    },
    "internet_service": { // NCT 2
      "download_speed": 76,
      "quality": 78,
      "reliability": 77,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 70,
      "more_choices": 64,
      "record_shows": 58
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 88,
      "privacy": 87,
      "data": 83
    },

    "id": "AR",
    "name": "Arkansas"
  },
  "CA": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 78,
      "local": 75,
      "job": 64
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 82,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 69,
      "record_shows": 64
    },
    "gig_speed": 64, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 88,
      "data": 85
    },
    "id": "CA",
    "name": "California"
  },
  "CO": {
    "helped_local_communities": 56, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 79,
      "local": 77,
      "job": 63
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 81,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 76,
      "more_choices": 68,
      "record_shows": 62
    },
    "gig_speed": 63, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 89,
      "data": 85
    },
    "id": "CO",
    "name": "Colorado"
  },
  "CT": {
    "helped_local_communities": 52, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 78,
      "local": 75,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 82,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 68,
      "record_shows": 60
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 90,
      "data": 85
    },
    "id": "CT",
    "name": "Connecticut"
  },
  "DE": {
    "helped_local_communities": 57, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 77,
      "local": 75,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 83,
      "reliability": 82,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 62,
      "record_shows": 58
    },
    "gig_speed": 57, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 88,
      "privacy": 87,
      "data": 83
    },
    "id": "DE",
    "name": "Delaware",
  },
  "DC": {
    "helped_local_communities": 57, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 79,
      "local": 76,
      "job": 73
    },
    "internet_service": { // NCT 2
      "download_speed": 84,
      "quality": 86,
      "reliability": 86,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 84,
      "more_choices": 75,
      "record_shows": 72
    },
    "gig_speed": 67, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 88,
      "privacy": 89,
      "data": 87
    },
    "id": "DC",
    "name": "District Of Columbia"
  },
  "FL": {
    "helped_local_communities": 59, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 74,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 82,
      "reliability": 81,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 66,
      "record_shows": 60
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 88,
      "data": 84
    },
    "id": "FL",
    "name": "Florida"
  },
  "GA": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 78,
      "local": 76,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 81,
      "reliability": 81,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 68,
      "record_shows": 63
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 84
    },
    "id": "GA",
    "name": "Georgia"
  },
  "HI": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 77,
      "local": 75,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 83,
      "reliability": 84,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 64,
      "record_shows": 58
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 88,
      "data": 84
    },
    "id": "HI",
    "name": "Hawaii"
  },
  "ID": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 78,
      "local": 75,
      "job": 56
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 78,
      "reliability": 78,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 68,
      "more_choices": 61,
      "record_shows": 56
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 86,
      "data": 82
    },
    "id": "ID",
    "name": "Idaho"
  },
  "IL": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 73,
      "job": 61
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 83,
      "reliability": 82,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 76,
      "more_choices": 67,
      "record_shows": 62
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 89,
      "data": 85
    },
    "id": "IL",
    "name": "Illinois"
  },
  "IN": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 74,
      "local": 73,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 80,
      "reliability": 79,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 69,
      "more_choices": 63,
      "record_shows": 57
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 89,
      "privacy": 86,
      "data": 83
    },
    "id": "IN",
    "name": "Indiana"
  },
  "IA": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 75,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 78,
      "reliability": 79,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 68,
      "more_choices": 60,
      "record_shows": 56
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 86,
      "data": 83
    },
    "id": "IA",
    "name": "Iowa"
  },
  "KS": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 74,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 81,
      "reliability": 80,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 65,
      "record_shows": 58
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 88,
      "data": 84
    },
    "id": "KS",
    "name": "Kansas"
  },
  "KY": {
    "helped_local_communities": 52, // NCT 7
    "economy": { // NCT 6
      "us": 77,
      "state": 74,
      "local": 72,
      "job": 55
    },
    "internet_service": { // NCT 2
      "download_speed": 76,
      "quality": 78,
      "reliability": 77,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 66,
      "record_shows": 59
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 83
    },
    "id": "KY",
    "name": "Kentucky"
  },
  "LA": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 73,
      "job": 56
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 79,
      "reliability": 77,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 67,
      "record_shows": 61
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 88,
      "privacy": 87,
      "data": 84
    },
    "id": "LA",
    "name": "Louisiana"
  },
  "ME": {
    "helped_local_communities": 59, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 75,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 81,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 64,
      "record_shows": 57
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 84
    },
    "id": "ME",
    "name": "Maine"
  },
  "MD": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 78,
      "local": 76,
      "job": 65
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 85,
      "reliability": 84,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 68,
      "record_shows": 60
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 89,
      "data": 85
    },
    "id": "MD",
    "name": "Maryland"
  },
  "MA": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 78,
      "local": 77,
      "job": 64
    },
    "internet_service": { // NCT 2
      "download_speed": 81,
      "quality": 84,
      "reliability": 83,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 64,
      "record_shows": 59
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 89,
      "data": 83
    },
    "id": "MA",
    "name": "Massachusetts"
  },
  "MI": {
    "helped_local_communities": 56, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 79,
      "local": 75,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 82,
      "reliability": 80,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 65,
      "record_shows": 60
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 88,
      "data": 85
    },
    "id": "MI",
    "name": "Michigan"
  },
  "MN": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 77,
      "local": 75,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 82,
      "reliability": 82,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 72,
      "more_choices": 63,
      "record_shows": 58
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 86,
      "dependable": 90,
      "privacy": 88,
      "data": 85
    },
    "id": "MN",
    "name": "Minnesota"
  },
  "MS": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 73,
      "job": 55
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 80,
      "reliability": 77,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 74,
      "more_choices": 67,
      "record_shows": 62
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 85
    },
    "id": "MS",
    "name": "Mississippi"
  },
  "MO": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 76,
      "local": 73,
      "job": 56
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 80,
      "reliability": 80,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 62,
      "record_shows": 57
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 87,
      "data": 84
    },
    "id": "MO",
    "name": "Missouri"
  },
  "MT": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 75,
      "job": 56
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 80,
      "reliability": 78,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 64,
      "record_shows": 58
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 88,
      "data": 84
    },
    "id": "MT",
    "name": "Montana"
  },
  "NE": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 75,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 79,
      "reliability": 79,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 69,
      "more_choices": 63,
      "record_shows": 56
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 88,
      "data": 83
    },
    "id": "NE",
    "name": "Nebraska"
  },
  "NV": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 74,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 81,
      "reliability": 80,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 66,
      "record_shows": 61
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 88,
      "data": 85
    },
    "id": "NV",
    "name": "Nevada"
  },
  "NH": {
    "helped_local_communities": 57, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 79,
      "local": 77,
      "job": 61
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 82,
      "reliability": 83,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 70,
      "more_choices": 63,
      "record_shows": 55
    },
    "gig_speed": 59, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 89,
      "data": 83
    },
    "id": "NH",
    "name": "New Hampshire"
  },
  "NJ": {
    "helped_local_communities": 52, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 73,
      "job": 63
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 84,
      "reliability": 84,
      "security": 85
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 69,
      "record_shows": 58
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 91,
      "privacy": 90,
      "data": 85
    },
    "id": "NJ",
    "name": "New Jersey"
  },
  "NM": {
    "helped_local_communities": 58, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 75,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 78,
      "reliability": 78,
      "security": 79
    },
    "tv_experience": { // NCT 5
      "original_programming": 81,
      "more_choices": 70,
      "record_shows": 66
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 83,
      "dependable": 88,
      "privacy": 88,
      "data": 85
    },
    "id": "NM",
    "name": "New Mexico"
  },
  "NY": {
    "helped_local_communities": 59, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 78,
      "local": 75,
      "job": 63
    },
    "internet_service": { // NCT 2
      "download_speed": 84,
      "quality": 85,
      "reliability": 84,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 70,
      "record_shows": 65
    },
    "gig_speed": 67, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 89,
      "data": 85
    },
    "id": "NY",
    "name": "New York"
  },
  "NC": {
    "helped_local_communities": 57, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 76,
      "job": 60
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 79,
      "reliability": 78,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 67,
      "record_shows": 61
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 85
    },
    "id": "NC",
    "name": "North Carolina"
  },
  "ND": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 78,
      "local": 76,
      "job": 59
    },
    "internet_service": { // NCT 2
      "download_speed": 76,
      "quality": 80,
      "reliability": 79,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 67,
      "more_choices": 62,
      "record_shows": 55
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 88,
      "data": 83
    },
    "id": "ND",
    "name": "North Dakota"
  },
  "OH": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 73,
      "job": 55
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 81,
      "reliability": 79,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 65,
      "record_shows": 59
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 88,
      "data": 84
    },
    "id": "OH",
    "name": "Ohio"
  },
  "OK": {
    "helped_local_communities": 54, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 75,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 79,
      "reliability": 77,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 65,
      "record_shows": 59
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 88,
      "data": 83
    },
    "id": "OK",
    "name": "Oklahoma"
  },
  "OR": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 78,
      "local": 75,
      "job": 60
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 80,
      "reliability": 81,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 67,
      "record_shows": 61
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 89,
      "data": 85
    },

    "id": "OR",
    "name": "Oregon"
  },
  "PA": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 76,
      "local": 72,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 83,
      "reliability": 81,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 65,
      "record_shows": 58
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 88,
      "data": 83
    },
    "id": "PA",
    "name": "Pennsylvania"
  },
  "RI": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 74,
      "job": 60
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 82,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 75,
      "more_choices": 65,
      "record_shows": 61
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 88,
      "data": 84
    },
    "id": "RI",
    "name": "Rhode Island"
  },
  "SC": {
    "helped_local_communities": 56, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 75,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 80,
      "reliability": 80,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 62,
      "record_shows": 58
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 87,
      "data": 83
    },
    "id": "SC",
    "name": "South Carolina"
  },
  "SD": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 75,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 80,
      "reliability": 79,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 68,
      "more_choices": 62,
      "record_shows": 55
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 90,
      "privacy": 87,
      "data": 83
    },
    "id": "SD",
    "name": "South Dakota"
  },
  "TN": {
    "helped_local_communities": 53, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 77,
      "local": 75,
      "job": 55
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 80,
      "reliability": 78,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 70,
      "more_choices": 63,
      "record_shows": 57
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 86,
      "data": 83
    },
    "id": "TN",
    "name": "Tennessee"
  },
  "TX": {
    "helped_local_communities": 57, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 79,
      "local": 76,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 78,
      "quality": 79,
      "reliability": 79,
      "security": 80
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 68,
      "record_shows": 64
    },
    "gig_speed": 63, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 89,
      "privacy": 88,
      "data": 84
    },
    "id": "TX",
    "name": "Texas"
  },
  "UT": {
    "helped_local_communities": 51, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 74,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 77,
      "quality": 81,
      "reliability": 80,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 68,
      "more_choices": 65,
      "record_shows": 57
    },
    "gig_speed": 62, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 87,
      "data": 84
    },
    "id": "UT",
    "name": "Utah"
  },
  "VT": {
    "helped_local_communities": 65, // NCT 7
    "economy": { // NCT 6
      "us": 82,
      "state": 80,
      "local": 79,
      "job": 60
    },
    "internet_service": { // NCT 2
      "download_speed": 82,
      "quality": 81,
      "reliability": 80,
      "security": 77
    },
    "tv_experience": { // NCT 5
      "original_programming": 76,
      "more_choices": 59,
      "record_shows": 59
    },
    "gig_speed": 56, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 87,
      "privacy": 85,
      "data": 82
    },
    "id": "VT",
    "name": "Vermont"
  },
  "VA": {
    "helped_local_communities": 56, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 77,
      "local": 75,
      "job": 62
    },
    "internet_service": { // NCT 2
      "download_speed": 79,
      "quality": 80,
      "reliability": 81,
      "security": 82
    },
    "tv_experience": { // NCT 5
      "original_programming": 73,
      "more_choices": 64,
      "record_shows": 59
    },
    "gig_speed": 63, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 87,
      "data": 83
    },
    "id": "VA",
    "name": "Virginia"
  },
  "WA": {
    "helped_local_communities": 55, // NCT 7
    "economy": { // NCT 6
      "us": 81,
      "state": 79,
      "local": 75,
      "job": 64
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 82,
      "reliability": 83,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 77,
      "more_choices": 70,
      "record_shows": 63
    },
    "gig_speed": 64, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 91,
      "privacy": 90,
      "data": 86
    },
    "id": "WA",
    "name": "Washington"
  },
  "WV": {
    "helped_local_communities": 50, // NCT 7
    "economy": { // NCT 6
      "us": 78,
      "state": 76,
      "local": 71,
      "job": 51
    },
    "internet_service": { // NCT 2
      "download_speed": 75,
      "quality": 79,
      "reliability": 77,
      "security": 83
    },
    "tv_experience": { // NCT 5
      "original_programming": 71,
      "more_choices": 67,
      "record_shows": 58
    },
    "gig_speed": 60, // NCT 4
    "internet_features": { // NCT 3
      "speed": 84,
      "dependable": 90,
      "privacy": 88,
      "data": 84
    },
    "id": "WV",
    "name": "West Virginia"
  },
  "WI": {
    "helped_local_communities": 58, // NCT 7
    "economy": { // NCT 6
      "us": 80,
      "state": 78,
      "local": 76,
      "job": 58
    },
    "internet_service": { // NCT 2
      "download_speed": 80,
      "quality": 81,
      "reliability": 80,
      "security": 81
    },
    "tv_experience": { // NCT 5
      "original_programming": 72,
      "more_choices": 61,
      "record_shows": 57
    },
    "gig_speed": 58, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 89,
      "privacy": 87,
      "data": 84
    },
    "id": "WI",
    "name": "Wisconsin"
  },
  "WY": {
    "helped_local_communities": 50, // NCT 7
    "economy": { // NCT 6
      "us": 79,
      "state": 76,
      "local": 74,
      "job": 57
    },
    "internet_service": { // NCT 2
      "download_speed": 74,
      "quality": 78,
      "reliability": 78,
      "security": 84
    },
    "tv_experience": { // NCT 5
      "original_programming": 70,
      "more_choices": 67,
      "record_shows": 57
    },
    "gig_speed": 61, // NCT 4
    "internet_features": { // NCT 3
      "speed": 85,
      "dependable": 91,
      "privacy": 89,
      "data": 84
    },
    "id": "WY",
    "name": "Wyoming"
  }
}


jQuery(function($){

  // flags for whether charts have appeared
  var internetChart = false;
  var internetChartEl = $('.internet-service .chart');

  var donutChart = false;
  var donutChartEl = $('.donut-chart');

  // check if element is in the viewport
  var isInViewport = function(el) {
    var elementTop = el.offset().top;
    var elementBottom = elementTop + el.outerHeight();
    var viewportTop = jQuery(window).scrollTop();
    var viewportBottom = viewportTop + jQuery(window).height();
    return elementBottom > viewportTop && elementTop < viewportBottom;
  };

  $(window).on('load resize scroll', function() {
    var throttled = false;
    var delay = 250;

    // only run if we're not throttled
    if (!throttled) {
      var w = window.innerWidth;

      buildCharts();

      // we're throttled!
      throttled = true;

      // set a timeout to un-throttle
      setTimeout(function() {
        throttled = false;
      }, delay);
    }
  });


  // initialize d3 charts in mobile
  function buildCharts() {
    // only run if we're not throttled
    if (!internetChart && isInViewport(internetChartEl)) {
      internetServiceChart();
      internetChart = true;
    }

    if (!donutChart && isInViewport(donutChartEl)) {
      createDonutChart('.future .donut-chart', 80);
      donutChart = true;
    }
  }


  // function to generate each donut chart
  function createDonutChart(selector, percent) {
    var duration = 2000;
    var transition = 200;
    var width = $(selector).width();
    var height = width;
    var viewBox = "0 0 " + width + " " + height;

    var dataset = {
                lower: calcPercent(0),
                upper: calcPercent(percent)
            },
            radius = Math.min(width, height) / 2.25,
            pie = d3.layout.pie().sort(null),
            format = d3.format(".0%");

    var arc = d3.svg.arc()
            .innerRadius(radius * .5)
            .outerRadius(radius);

    var svg = d3.select(selector).append("svg")
            .attr("viewBox", viewBox)
            .append("g")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

    var path = svg.selectAll("path")
                    .data(pie(dataset.lower))
                    .enter().append("path")
                    .attr("class", function (d, i) {
                        return "color" + i
                    })
                    .attr("d", arc)
                    .each(function (d) {
                        this._current = d;
                    });

    var progress = 0;

    var timeout = setTimeout(function () {
        clearTimeout(timeout);
        path = path.data(pie(dataset.upper));
        path.transition().duration(duration).attrTween("d", function (a) {
            var i = d3.interpolate(this._current, a);
            var i2 = d3.interpolate(progress, percent)
            this._current = i(0);
            return function (t) {
                return arc(i(t));
            };
        });
    }, 200);

    function calcPercent(percent) {
        return [percent, 100 - percent];
    };
  }


  // infrastructure investment chart
  function internetServiceChart() {
    var data, margin, width, height, viewBox, x, y,
        tickLabels, xAxis, yAxis, svg, bar;

    //
    data = [{"category":"Satisfied with quality", "number": 30},
            {"category":"Satisfied with reliability", "number": 40},
            {"category":"Satisfied with security", "number": 50},
            {"category":"Satisfied with speed of downloads", "number": 55.8}];

    // dimensions
    margin = {top: 120, right: 20, bottom: 80, left: 80};
    width = 1140 - margin.left - margin.right;
    height = 600 - margin.top - margin.bottom;
    viewBox = "0 0 1140 600";

    x = d3.scale.ordinal()
        .rangeRoundBands([0, width], .05);

    y = d3.scale.linear()
        .range([height, 0]);

    xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom");

    yAxis = d3.svg.axis()
        .scale(y)
        .orient("left");

    svg = d3.select(".internet-chart").append("svg")
        .attr("preserveAspectRatio", "xMinYMin meet")
        .attr("viewBox", viewBox)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    data.forEach(function(d) {
      d.year = parseDate(d.year);
    });

    x.domain(data.map(function(d) { return d.year; }));
    y.domain([0,300]);

    // add axes and labels
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis)
      .append("text")
        .attr("y", 60)
        .attr("x", 540)
        .attr("dy", ".71em")
        .attr("class", "axis-label")
        .style("text-anchor", "end")
        .text("Year");
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
      .append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", -80)
        .attr("x", 0)
        .attr("dy", ".71em")
        .attr("class", "axis-label")
        .style("text-anchor", "end")
        .text("Amount (Dollars)");

    // Bars
  bar = svg.selectAll(".chart-bar")
        .data(data)
        .enter().append("rect")
        .attr("class", "chart-bar")
        .attr("x", function(d) { return x(d.year); })
        .attr("y", height)
        .attr("width", x.rangeBand())
        .attr("height", 0);

  bar.transition()
      .duration(2000)
      .ease("ease-in-out")
      .delay(function(d, i) {
        return i / data.length * 1000;  // Dynamic delay (each item delays a little longer)
      })
      .attr("y", function(d) { return y(d.number); })
      .attr("height", function(d) { return height - y(d.number); })
      .each("end", function() {
        d3.selectAll(".text-group.reveal").attr("class", function(d) {
          return 'text-group reveal animated';
        });
      });

  labelGroup = svg.selectAll(".text-group")
    .data(data)
    .enter()
    .append("g")
    .attr("class", "text-group")
    .attr("x", function(d) { return x(d.category) + (x.rangeBand() / 2) })
    .attr("y", function(d){
      return y(d.number) - 80;
    });

  var textStat = labelGroup.append("text")
      .attr("x", function(d) { return d3.select(this.parentNode).attr('x'); })
      .attr("y", function(d) { return parseInt(d3.select(this.parentNode).attr('y')) - 3; } )
      .attr("class", "text-stat")
      .attr("text-anchor", "middle");

  textStat.append("tspan")
      .text(function(d) { return d.number; })
      .attr("class", "text-stat-number")
      .attr("text-anchor", "middle");

  textStat.append("tspan")
      .text("%")
      .attr("class", "text-stat-suffix")
      .attr("dx", 2)
      .attr("text-anchor", "middle");

  }








});
